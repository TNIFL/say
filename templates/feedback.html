{% extends "base.html" %}

{% block title %}{{ _("Lexinoa · 피드백") }}{% endblock %}

{% block head_extra %}
  <style>
    .alert{
      border:1px solid var(--danger); color:#fff; background:rgba(239,68,68,.12);
      padding:10px 12px; border-radius:12px; font-size:13px;
    }
    body.light .alert{color:#7f1d1d}
    .success{
      border:1px solid var(--ok); background:rgba(16,185,129,.12);
      color:#d1fae5; padding:10px 12px; border-radius:12px; font-size:13px;
    }
    body.light .success{color:#065f46}
    /* === 폼 요소 다크/라이트 가시성 개선 === */
    body { color-scheme: dark; }
    body.light { color-scheme: light; }

    :root{
      --control-bg:#10141c;
      --control-bg-focus:#151b26;
      --control-text:var(--text);
      --control-border:var(--border);
      --control-placeholder:color-mix(in srgb, var(--text) 45%, transparent);
    }
    body.light{
      --control-bg:#ffffff;
      --control-bg-focus:#f4f7fb;
      --control-text:#1a1c22;
      --control-border:#d6d8e0;
      --control-placeholder:#9aa0ae;
    }

    /* input / select / textarea 공통 */
    select, textarea, input[type="text"], input[type="email"] {
      background-color: var(--control-bg);
      color: var(--control-text);
      border: 1px solid var(--control-border);
      border-radius: 12px;
      padding: 12px;
      outline: none;
      transition: border-color .15s, background-color .15s, color .15s;
    }

    input::placeholder, textarea::placeholder {
      color: var(--control-placeholder);
    }

    select:focus, textarea:focus, input[type="text"]:focus, input[type="email"]:focus {
      background-color: var(--control-bg-focus);
      border-color: var(--accent);
      outline: 2px solid color-mix(in srgb, var(--accent) 35%, transparent);
      outline-offset: 1px;
    }

    select option {
      background: var(--panel);
      color: var(--text);
    }

    select:hover, textarea:hover, input[type="text"]:hover, input[type="email"]:hover {
      border-color: color-mix(in srgb, var(--accent) 35%, var(--control-border));
    }

    /* 두 컬럼 필드 정렬 고정 */
    .two-col{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:12px;
      align-items:start; /* 라벨 기준 동일 시작점 */
    }
    @media (max-width:880px){
      .two-col{ grid-template-columns:1fr; }
    }

    .field{
      display:grid;
      gap:6px;
    }

    /* 이메일/텍스트 인풋 높이/폭 강제 통일 */
    select, textarea, input[type="text"], input[type="email"]{
      width:100%;
      min-height:44px; /* 같은 높이 */
      line-height:1.2; /* 브라우저 기본차 제거 */
    }

    #message{
      min-height: 220px;   /* 원하는 값으로 조절 (예: 180~320px) */
      resize: vertical;    /* 사용자가 세로로 더 늘릴 수 있게 */
    }

  </style>
{% endblock %}

{% block content %}
    <!-- Feedback Card -->
    <section class="card" style="max-width:680px; margin:24px auto;">
      <h3>{{ _("건의사항 / 피드백") }}</h3>
      <p class="small">{{ _("서비스 개선을 위해 자유롭게 의견을 남겨주세요.") }}</p>

      {% if error %}
        <div class="alert" role="alert">{{ error }}</div>
      {% endif %}
      {% if success %}
        <div class="success" role="status">{{ success }}</div>
      {% endif %}

      <form method="post" action="/feedback" class="stack" style="display:grid; gap:12px;">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <div>
          <label class="small" for="category">{{ _("카테고리") }}</label>
          <select id="category" name="category">
            <option value="general" {% if category=='general' %}selected{% endif %}>{{ _("일반") }}</option>
            <option value="bug" {% if category=='bug' %}selected{% endif %}>{{ _("버그 신고") }}</option>
            <option value="ux" {% if category=='ux' %}selected{% endif %}>{{ _("UX 제안") }}</option>
            <option value="idea" {% if category=='idea' %}selected{% endif %}>{{ _("기능 아이디어") }}</option>
            <option value="other" {% if category=='other' %}selected{% endif %}>{{ _("기타") }}</option>
          </select>
        </div>

        <div class="two-col">
          <div class="field">
            <label class="small" for="user_id">{{ _("아이디(선택)") }}</label>
            <input type="text" id="user_id" name="user_id"
                   placeholder="{{ _("로그인 아이디") }}" value="{{ user_id or '' }}" />
          </div>

          <div class="field">
            <label class="small" for="email">{{ _("이메일(선택, 답변용)") }}</label>
            <input type="email" id="email" name="email"
                   placeholder="you@example.com" value="{{ email or '' }}" />
          </div>
        </div>


        <div>
          <label class="small" for="message">{{ _("내용") }}</label>
          <textarea id="message" name="message" placeholder="{{ _("어떤 점이 불편했나요? 또는 어떤 기능이 있으면 좋겠나요?") }}">{{ message or '' }}</textarea>
        </div>

        <input type="hidden" name="page" value="{{ page or '/' }}"/>

        <div class="toolbar" style="margin-top:8px;">
          <span class="spacer"></span>
          <a class="btn ghost" href="/">{{ _("취소") }}</a>
          <button class="btn" type="submit">{{ _("제출") }}</button>
        </div>
      </form>
    </section>
{% endblock %}

{% block scripts %}
  <script src="{{ url_for('static', filename='js/feedback.js') }}" defer></script>
{% endblock %}
